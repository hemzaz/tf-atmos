---
# US-East-1 (N. Virginia) regional configuration mixin
# Disaster recovery region with cost-optimized settings

vars:
  # Regional identification
  region: "us-east-1"
  region_name: "N. Virginia"
  availability_zones:
    - "us-east-1a"
    - "us-east-1b"
    - "us-east-1c"
    - "us-east-1d"
    - "us-east-1e"
    - "us-east-1f"

  # Regional networking configuration
  regional_networking:
    # VPC CIDR allocation (different from us-west-2)
    vpc_cidr_allocation:
      production: "10.10.0.0/16"   # 10.10.0.0 - 10.10.255.255
      staging: "10.11.0.0/16"      # 10.11.0.0 - 10.11.255.255
      development: "10.12.0.0/16"  # 10.12.0.0 - 10.12.255.255

    # Subnet allocation (per AZ)
    subnet_allocation:
      public_cidr_block: "/24"     # 256 IPs per public subnet
      private_cidr_block: "/22"    # 1024 IPs per private subnet
      database_cidr_block: "/24"   # 256 IPs per database subnet

    # NAT Gateway configuration (cost-optimized for DR)
    nat_gateway:
      high_availability: false     # Single NAT GW for cost savings in DR
      single_nat_gateway: true

  # Regional compute configuration
  regional_compute:
    # EC2 instance types (cost-optimized for DR)
    preferred_instance_types:
      - "t3.medium"
      - "t3.large"
      - "m5.large"
      - "c5.large"

    # EKS configuration (minimal for DR)
    eks:
      version: "1.28"
      endpoint_private_access: true
      endpoint_public_access: false
      node_groups:
        default_instance_types: ["t3.medium", "t3.large"]
        capacity_type: "SPOT"  # Use spot instances for cost savings

  # Regional storage configuration
  regional_storage:
    # EBS configuration
    ebs:
      volume_type: "gp3"
      encryption_enabled: true

    # S3 configuration (receive replication from us-west-2)
    s3:
      replication_source_region: "us-west-2"
      storage_class: "STANDARD_IA"  # Infrequent Access for cost savings
      intelligent_tiering: true

  # Regional database configuration
  regional_database:
    # RDS configuration (read replicas)
    rds:
      multi_az: false              # Single AZ for cost savings in DR
      preferred_backup_window: "06:00-07:00"      # UTC (different from primary)
      preferred_maintenance_window: "sun:07:00-sun:08:00"  # UTC
      backup_retention_period: 14  # Longer retention for DR
      read_replica: true

    # ElastiCache configuration (minimal)
    elasticache:
      node_type: "cache.t3.micro"
      num_cache_nodes: 1           # Single node for DR

  # Regional monitoring (reduced for cost optimization)
  regional_monitoring:
    # CloudWatch configuration
    cloudwatch:
      log_retention_in_days: 30    # Shorter retention for DR
      metrics_collection_interval: 600  # Less frequent collection

    # X-Ray configuration (disabled for cost savings)
    xray:
      tracing_config: "PassThrough"

  # Regional disaster recovery
  disaster_recovery:
    # This IS the disaster recovery region
    is_disaster_recovery_region: true
    primary_region: "us-west-2"

    # RTO/RPO settings
    recovery_time_objective: "8h"   # Longer RTO for DR region
    recovery_point_objective: "4h"  # Longer RPO for DR region

    # Automated failover settings
    automated_failover_enabled: false  # Manual failover for safety

# Regional-specific component configurations
components:
  terraform:
    # AWS provider configuration for us-east-1
    aws:
      region: "us-east-1"

# Regional tags
tags:
  Region: "us-east-1"
  RegionName: "N. Virginia"
  PrimaryRegion: "false"
  DisasterRecoveryRegion: "true"
  SourceRegion: "us-west-2"
  Timezone: "America/New_York"
  CostOptimized: "true"