---
# ISO 27001 Information Security Management System (ISMS) compliance mixin
# Implements security controls required for ISO 27001 certification

vars:
  # ISO 27001 compliance identification
  compliance_framework: "iso27001"
  compliance_version: "2013"
  certification_body: "accredited_certification_body"

  # ISO 27001 ISMS Framework
  isms_framework:
    # ISMS Policy
    isms_policy:
      information_security_policy: true
      policy_review_frequency: "annual"
      policy_approval_authority: "senior_management"

    # ISMS Scope
    isms_scope:
      scope_definition: true
      scope_boundaries: "defined"
      scope_exclusions: "documented"

    # Risk Management
    risk_management:
      risk_assessment_methodology: true
      risk_treatment_plan: true
      risk_register: true
      risk_review_frequency: "quarterly"

  # ISO 27001 Annex A Controls
  annex_a_controls:
    # A.5 Information Security Policies
    a5_policies:
      information_security_policy: true
      review_of_information_security_policies: true

    # A.6 Organization of Information Security
    a6_organization:
      information_security_responsibilities: true
      segregation_of_duties: true
      contact_with_authorities: true
      contact_with_special_interest_groups: true
      information_security_in_project_management: true
      mobile_device_policy: true
      teleworking: true

    # A.7 Human Resource Security
    a7_human_resources:
      screening: true
      terms_and_conditions_of_employment: true
      disciplinary_process: true
      information_security_responsibilities: true
      remote_working: true
      information_security_awareness_education_training: true
      confidentiality_or_non_disclosure_agreements: true
      return_of_assets: true
      removal_of_access_rights: true

    # A.8 Asset Management
    a8_asset_management:
      inventory_of_assets: true
      ownership_of_assets: true
      acceptable_use_of_assets: true
      return_of_assets: true
      information_classification: true
      labeling_of_information: true
      handling_of_assets: true
      management_of_removable_media: true
      disposal_of_media: true
      physical_media_transfer: true

    # A.9 Access Control
    a9_access_control:
      access_control_policy: true
      access_to_networks_and_network_services: true
      user_registration_and_deregistration: true
      user_access_provisioning: true
      management_of_privileged_access_rights: true
      management_of_secret_authentication_information_of_users: true
      review_of_user_access_rights: true
      removal_or_adjustment_of_access_rights: true
      use_of_privileged_utility_programs: true
      access_control_to_program_source_code: true
      secure_log_on_procedures: true
      password_management_system: true

    # A.10 Cryptography
    a10_cryptography:
      policy_on_the_use_of_cryptographic_controls: true
      key_management: true

    # A.11 Physical and Environmental Security
    a11_physical_environmental:
      physical_security_perimeter: true
      physical_entry_controls: true
      protection_against_environmental_threats: true
      equipment_maintenance: true
      removal_of_assets: true
      security_of_equipment_and_assets_off_premises: true
      secure_disposal_or_reuse_of_equipment: true
      unattended_user_equipment: true
      clear_desk_and_clear_screen_policy: true

    # A.12 Operations Security
    a12_operations:
      operating_procedures_and_responsibilities: true
      change_management: true
      capacity_management: true
      separation_of_development_testing_and_operational_environments: true
      malware_protection: true
      backup: true
      event_logging: true
      monitoring_activities: true
      protection_of_log_information: true
      administrator_and_operator_logs: true
      clock_synchronization: true
      installation_of_software_on_operational_systems: true
      management_of_technical_vulnerabilities: true
      information_systems_audit_considerations: true

    # A.13 Communications Security
    a13_communications:
      network_security_management: true
      security_of_network_services: true
      segregation_in_networks: true
      information_transfer_policies_and_procedures: true
      agreements_on_information_transfer: true
      electronic_messaging: true
      confidentiality_or_non_disclosure_agreements: true

    # A.14 System Acquisition, Development and Maintenance
    a14_development:
      information_security_requirements_analysis_and_specification: true
      securing_application_services_on_public_networks: true
      protecting_application_services_transactions: true
      security_in_development_and_support_processes: true
      system_security_testing: true
      system_change_control_procedures: true
      technical_review_of_applications_after_operating_platform_changes: true
      restrictions_on_changes_to_software_packages: true
      secure_system_engineering_principles: true
      secure_development_environment: true
      outsourced_development: true
      system_acceptance_testing: true

    # A.15 Supplier Relationships
    a15_supplier:
      information_security_policy_for_supplier_relationships: true
      addressing_security_within_supplier_agreements: true
      information_and_communication_technology_supply_chain: true
      monitoring_and_review_of_supplier_services: true
      managing_changes_to_supplier_services: true

    # A.16 Information Security Incident Management
    a16_incident_management:
      responsibilities_and_procedures: true
      reporting_information_security_events: true
      reporting_information_security_weaknesses: true
      assessment_of_and_decision_on_information_security_events: true
      response_to_information_security_incidents: true
      learning_from_information_security_incidents: true
      collection_of_evidence: true

    # A.17 Information Security Aspects of Business Continuity Management
    a17_business_continuity:
      planning_information_security_continuity: true
      implementing_information_security_continuity: true
      verify_review_and_evaluate_information_security_continuity: true
      availability_of_information_processing_facilities: true

    # A.18 Compliance
    a18_compliance:
      identification_of_applicable_legislation_and_contractual_requirements: true
      intellectual_property_rights: true
      protection_of_records: true
      privacy_and_protection_of_personally_identifiable_information: true
      regulation_of_cryptographic_controls: true
      independent_review_of_information_security: true
      compliance_with_security_policies_and_standards: true
      technical_compliance_review: true

# ISO 27001 specific monitoring and measurement
monitoring_measurement:
  # Performance monitoring
  performance_monitoring:
    security_metrics: true
    performance_indicators: true
    measurement_frequency: "monthly"

  # Internal audit
  internal_audit:
    audit_program: true
    audit_frequency: "annual"
    audit_scope: "full_isms"

  # Management review
  management_review:
    review_frequency: "annual"
    review_inputs: "defined"
    review_outputs: "documented"

# ISO 27001 continuous improvement
continuous_improvement:
  improvement_process: true
  corrective_actions: true
  preventive_actions: true
  lessons_learned: true

# ISO 27001-specific component configurations
components:
  terraform:
    # ISO 27001 compliance settings
    compliance_validation: true
    security_scanning: true
    vulnerability_assessment: true

    # Documentation requirements
    documentation_required: true
    change_documentation: true
    approval_documentation: true

    # Audit requirements
    audit_logging:
      enabled: true
      log_retention_days: 2190  # 6 years minimum
      log_encryption: true
      log_integrity_protection: true
      log_access_controls: true

# ISO 27001 compliance tags
tags:
  ComplianceFramework: "ISO27001"
  ComplianceVersion: "2013"
  ISMSImplemented: "true"
  RiskAssessmentCompleted: "true"
  SecurityControlsImplemented: "true"
  AuditScope: "true"
  ContinualImprovementEnabled: "true"
  DocumentationMaintained: "true"
  IncidentManagementEnabled: "true"
  BusinessContinuityEnabled: "true"
  SupplierSecurityEnabled: "true"
  ComplianceMonitoringEnabled: "true"